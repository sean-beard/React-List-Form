var FieldCustomizer = (function () {
    function FieldCustomizer(serverURL) {
        this._listFieldInternalValues = [];
        this._serverURL = serverURL;
        this._listName = 'TABTestFieldCustomizerList';
    }
    FieldCustomizer.prototype.TestName = function () {
        return 'FieldCustomizer Test';
    };
    FieldCustomizer.prototype.TestOwner = function () {
        return 'dagaeta';
    };
    FieldCustomizer.prototype.TestIncludeScripts = function () {
        return [
            '<ProductScriptsLocation>msajaxbundle.debug.js',
            '<ProductScriptsLocation>sp.runtime.debug.js',
            '<ProductScriptsLocation>sp.debug.js',
            '<TestLocation>/TabTaskLib.debug.js',
            '<AzureTaskLibLocation>/sp-tab-tasklib.js'
        ];
    };
    FieldCustomizer.prototype.TestSetup = function () {
        var _this = this;
        TAB.Log.Comment('FieldCustomizer test start');
        this._listFields = [
            new SPTaskLib.Controls.Field('Percent', 'A simple number field.', SPTaskLib.Controls.FieldType.Number, false , false )
        ];
        this._listFieldInternalValues = [
            [10],
            [50],
            [80]
        ];
        var loadList = { success: false };
        this._list = new SPTaskLib.List(this._listName);
        this._list.addCsomTaskLoadList(loadList);
        TAB.AddTask(TAB.MakeTask(function () {
            if (!loadList.success) {
                TAB.Log.Comment('Creating list \'' + _this._listName + '\'');
                _this._list = new SPTaskLib.List(_this._listName);
                _this._list.addCsomTaskCreateList({
                    numberOfItems: 3,
                    additionalFields: _this._listFields,
                    fieldValues: _this._listFieldInternalValues
                });
            }
        }));
    };
    FieldCustomizer.prototype.TestRun = function () {
        var customListPagePath = "/Lists/" + this._listName + "/AllItems.aspx";
        var fieldCustomizers = '{"Percent":{"id":"c60bc741-08cf-4187-b914-39875486cb54",' +
            '"properties":{"sampleText":"Hello!"}}}';
        var spQueryParams = {
            loadSPFX: true,
            debugManifestsFile: SPTaskLib.PageUtil.GetDebugManifestsUrl(),
            fieldCustomizers: fieldCustomizers
        };
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(customListPagePath, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        var listPageReady = TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='DetailsRowCell']");
        });
        SPTaskLib.PageUtil.AddTaskClearSecurityDialog(listPageReady);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Validating field value\'s inner text was set' +
                'by FieldCustomizer (should be \'test-field-customizer\').');
            var percentFieldRows = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='fieldCustomizerDataContainer']");
            if (percentFieldRows.length === 0) {
                TAB.Log.AddTaskFail('Row Fields for column (Percent) are not present');
            }
            for (var _i = 0, percentFieldRows_1 = percentFieldRows; _i < percentFieldRows_1.length; _i++) {
                var percentRow = percentFieldRows_1[_i];
                if (!(percentRow.innerText.trim() === 'test-field-customizer')) {
                    TAB.Log.AddTaskFail('Row Field innerText was not modified by FieldCustomizer');
                }
            }
        }));
        TAB.Log.AddTaskPass('Test complete');
    };
    return FieldCustomizer;
}());
TabTest = FieldCustomizer;
