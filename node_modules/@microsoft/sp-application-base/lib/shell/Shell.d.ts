import { Environment, ServiceScope } from '@microsoft/sp-core-library';
import { PageManager, PageContext } from '@microsoft/sp-page-context';
import { HttpClient, SPHttpClient } from '@microsoft/sp-http';
import { _IPreloadedData as IPreloadedData } from '@microsoft/sp-loader';
import BaseApplication from '../BaseApplication';
import { ISuiteNavManager } from '../suiteNav/SuiteNavManager';
import ApplicationCustomizerLoader from '../extensibility/ApplicationCustomizerLoader';
/**
 * The system shell manages the initial loading of the scripts for a client-side application,
 * as well as constructin the BaseApplication object, and initializing key services such
 * as the page chrome, page context, HTTP client, etc.
 *
 * @alpha
 */
export interface IShell {
    /**
     * The current ServiceScope.
     */
    readonly serviceScope: ServiceScope;
    /**
     * Describes the type of environment that the framework is being hosted on.
     */
    environment: Environment;
    /**
     * Returns the current page context object for webparts.
     */
    pageContext: PageContext;
    /**
     * BasicHttpClient is used to perform REST calls with general internet services.
     * For communicating with SharePoint services, use HttpClient instead.
     */
    httpClient: HttpClient;
    /**
     * HttpClient is used to perform REST calls with SharePoint services.
     * It implements special enhancements such as configuring default headers, adding
     * an "X-RequestDigest" header for write operations, and collecting telemetry
     * to help the service monitor the performance and reliability of the application.
     *
     * For communicating with non-SharePoint services, use BasicHttpClient instead.
     */
    spHttpClient: SPHttpClient;
    /**
     * This object allows the application to manage the suite navigation of
     * the standard page chrome.  For more information about Suite Navigation,
     * see this article:
     * https://msdn.microsoft.com/en-us/library/office/dn614990.aspx
     */
    suiteNavManager: ISuiteNavManager;
    /**
     * This object contains data that was requested by the application's manifest.
     * The preloaded data's properties could be undefined.
     * @internal
     */
    manifestPreloads: IPreloadedData;
    /**
     * This class is used for interacting with the current page.
     * @internal
     */
    pageManager: PageManager;
    /**
     * The application customizer loader handles initializing and rendering application customizers.
     * @internal
     */
    applicationCustomizerLoader: ApplicationCustomizerLoader | undefined;
}
export interface IClientSideApplicationWrapper {
    default: BaseApplication;
}
/**
 * RESERVED FOR INTERNAL USAGE.  Applications interact with the shell via
 * the IShell interface.
 *
 * @internal
 */
export default class Shell implements IShell {
    private static classicPagesComponentId;
    private static workbenchComponentId;
    private static _logSource;
    private static _instance;
    private _rootServiceScope;
    private _spPageChrome;
    private _application;
    private _suiteNav;
    private _pageContext;
    private _httpClient;
    private _spHttpClient;
    private _environment;
    private _manifestPreloads;
    private _pageManager;
    private _applicationCustomizerLoader;
    static getInstance(): IShell;
    readonly serviceScope: ServiceScope;
    readonly pageContext: PageContext;
    readonly httpClient: HttpClient;
    readonly spHttpClient: SPHttpClient;
    readonly suiteNavManager: ISuiteNavManager;
    readonly environment: Environment;
    readonly manifestPreloads: IPreloadedData;
    readonly pageManager: PageManager;
    readonly applicationCustomizerLoader: ApplicationCustomizerLoader | undefined;
    start(module: IClientSideApplicationWrapper | BaseApplication, preloadedData: IPreloadedData): Promise<BaseApplication>;
    private _startApplication(application, preloadedData);
    private _initializePreload(preloadedData, application);
    private _initializeDigestCache(serviceScope, preloadedData);
    private _loadApplicationCustomizers();
}
