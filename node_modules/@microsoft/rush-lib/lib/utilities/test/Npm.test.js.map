{"version":3,"sources":["utilities/test/Npm.test.ts"],"names":[],"mappings":"AAAA,4FAA4F;AAC5F,2DAA2D;;;AAE3D,+BAA+B;AAE/B,6BAA8B;AAC9B,8BAAyB;AACzB,iCAAmC;AACnC,0CAAqC;AACrC,6BAA+B;AAE/B,QAAQ,CAAC,KAAK,EAAE;IACd,IAAM,WAAW,GAAW,2BAA2B,CAAC;IACxD,IAAI,IAAqB,CAAC;IAE1B,UAAU,CAAC;QACT,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,mBAAS,EAAE,gCAAgC,CAAC,CAAC;IACjE,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC;QACR,IAAI,CAAC,OAAO,EAAE,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iEAAiE,EAAE;QACpE,IAAM,IAAI,GAAW,sTAOnB,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAA,UAAQ,WAAW,iBAAc,CAAA,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC;aACjG,OAAO,CAAC,IAAI,CAAC,CAAC;QACjB,IAAM,QAAQ,GAAa,aAAG,CAAC,iBAAiB,CAAC,WAAW,EAC1D,SAAS,EACT,OAAO,CAAC,GAAG,CAAC,CAAC;QACf,aAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAC7B,4DAA4D,CAAC,CAAC;QAChE,aAAM,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,eAAe,CAAC,EAAE,oBAAoB,CAAC,CAAC;IACtG,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,oEAAoE,EAAE;QACvE,IAAM,IAAI,GAAW,yFAKnB,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAA,UAAQ,WAAW,iBAAc,CAAA,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC;aACjG,OAAO,CAAC,EAAE,CAAC,CAAC;QACf,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAA,UAAQ,WAAW,qBAAkB,CAAA,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC;aACrG,OAAO,CAAC,IAAI,CAAC,CAAC;QACjB,IAAM,QAAQ,GAAa,aAAG,CAAC,iBAAiB,CAAC,WAAW,EAC1D,SAAS,EACT,OAAO,CAAC,GAAG,CAAC,CAAC;QACf,aAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAC7B,4DAA4D,CAAC,CAAC;QAChE,aAAM,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,eAAe,CAAC,EAAE,oBAAoB,CAAC,CAAC;IACtG,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","file":"utilities/test/Npm.test.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\n/// <reference types='mocha' />\r\n\r\nimport { assert } from 'chai';\r\nimport Npm from '../Npm';\r\nimport * as process from 'process';\r\nimport Utilities from '../Utilities';\r\nimport * as sinon from 'sinon';\r\n\r\ndescribe('npm', () => {\r\n  const packageName: string = '@microsoft/rush-lib-never';\r\n  let stub: sinon.SinonStub;\r\n\r\n  beforeEach(() => {\r\n    stub = sinon.stub(Utilities, 'executeCommandAndCaptureOutput');\r\n  });\r\n\r\n  afterEach(() => {\r\n    stub.restore();\r\n  });\r\n\r\n  it('publishedVersions gets versions when package time is available.', () => {\r\n    const json: string = `{\r\n      \"modified\": \"2017-03-30T18:37:27.757Z\",\r\n      \"created\": \"2017-01-03T20:28:10.342Z\",\r\n      \"0.0.0\": \"2017-01-03T20:28:10.342Z\",\r\n      \"1.4.0\": \"2017-01-03T21:55:21.249Z\",\r\n      \"1.4.1\": \"2017-01-09T19:22:00.488Z\",\r\n      \"2.4.0-alpha.1\": \"2017-03-30T18:37:27.757Z\"\r\n    }`;\r\n    stub.withArgs('npm', `view ${packageName} time --json`.split(' '), sinon.match.any, sinon.match.any)\r\n      .returns(json);\r\n    const versions: string[] = Npm.publishedVersions(packageName,\r\n      __dirname,\r\n      process.env);\r\n    assert.equal(versions.length, 4,\r\n      'Four versions of @microsoft/rush-lib-never should be found');\r\n    assert.includeMembers(versions, ['0.0.0', '1.4.0', '1.4.1', '2.4.0-alpha.1'], 'All versions match');\r\n  });\r\n\r\n  it('publishedVersions gets versions when package time is not available', () => {\r\n    const json: string = `[\r\n      \"0.0.0\",\r\n      \"1.4.0\",\r\n      \"1.4.1\",\r\n      \"2.4.0-alpha.1\"\r\n    ]`;\r\n    stub.withArgs('npm', `view ${packageName} time --json`.split(' '), sinon.match.any, sinon.match.any)\r\n      .returns('');\r\n    stub.withArgs('npm', `view ${packageName} versions --json`.split(' '), sinon.match.any, sinon.match.any)\r\n      .returns(json);\r\n    const versions: string[] = Npm.publishedVersions(packageName,\r\n      __dirname,\r\n      process.env);\r\n    assert.equal(versions.length, 4,\r\n      'Four versions of @microsoft/rush-lib-never should be found');\r\n    assert.includeMembers(versions, ['0.0.0', '1.4.0', '1.4.1', '2.4.0-alpha.1'], 'All versions match');\r\n  });\r\n});"],"sourceRoot":"..\\..\\..\\src"}