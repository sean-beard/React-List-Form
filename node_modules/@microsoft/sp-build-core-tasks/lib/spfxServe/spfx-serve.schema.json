{
  "$schema": "http://json-schema.org/draft-04/schema#",

  "title": "SPFx Serve Task Configuration",
  "description": "Defines parameters for the webserver which is spun up by the SPFx Serve Task",
  "type": "object",

  "definitions": {
    "SpfxServeSessionConfiguration": {
      "type": "object",

      "additionalProperties": false,
      "required": [
        "pageUrl"
      ],
      "properties": {
        "pageUrl": {
          "title": "Page URL",
          "description": "The fully-qualified URL of the page to launch",
          "type": "string"
        },

        "customActions": {
          "title": "Custom Actions",
          "description": "An optional list of custom actions to provide as query parameters to the page. The key of this object must be the ID of the custom action component.",
          "type": "object",

          "additionalProperties": false,
          "patternProperties": {
            "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$": {
              "type": "object",

              "required": [
                "location"
              ],
              "properties": {
                "location": {
                  "title": "Location",
                  "description": "The type of custom action, use \"ClientSideExtension.ApplicationCustomizer\" for the Application Customizer extension.",
                  "type": "string",
                  "enum": [
                    "ClientSideExtension.ApplicationCustomizer",
                    "ClientSideExtension.ListViewCommandSet.ContextMenu",
                    "ClientSideExtension.ListViewCommandSet.CommandBar",
                    "ClientSideExtension.ListViewCommandSet"
                  ]
                },

                "properties": {
                  "type": "object"
                }
              }
            }
          }
        },

        "fieldCustomizers": {
          "title": "Field Customizers",
          "description": "An optional list of field customizers to provide as query parameters to the page. The key of this object must be the field ID the customizer applies to.",
          "type": "object",

          "additionalProperties": false,
          "patternProperties": {
            "^[A-z0-9]+$": {
              "type": "object",

              "required": [
                "id"
              ],
              "properties": {
                "id": {
                  "title": "ID",
                  "description": "The ID of the field customizer component.",
                  "type": "string",
                  "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
                },

                "properties": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    }
  },

  "additionalProperties": false,
  "properties": {
    "serveConfigurations": {
      "title": "Serve Configurations",
      "description": "Specify a set of configurations that the serve task can use to load a test page",
      "type": "object",

      "additionalProperties": false,
      "required": [
        "default"
      ],
      "properties": {
        "default": {
          "$ref": "#/definitions/SpfxServeSessionConfiguration"
        }
      },
      "patternProperties": {
        "\\S+": {
          "$ref": "#/definitions/SpfxServeSessionConfiguration"
        }
      }
    }
  }
}