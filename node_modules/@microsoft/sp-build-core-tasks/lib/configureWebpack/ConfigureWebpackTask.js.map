{"version":3,"sources":["configureWebpack/ConfigureWebpackTask.ts"],"names":[],"mappings":"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","file":"configureWebpack/ConfigureWebpackTask.js","sourcesContent":["import * as lodash from 'lodash';\r\nimport * as Gulp from 'gulp';\r\nimport * as path from 'path';\r\nimport * as webpack from 'webpack';\r\nimport * as fsx from 'fs-extra';\r\nimport { EOL } from 'os';\r\n\r\nimport { WebpackTask } from '@microsoft/gulp-core-build-webpack';\r\nimport { KarmaTask } from '@microsoft/gulp-core-build-karma/lib/KarmaTask';\r\nimport {\r\n  ISetWebpackPublicPathPluginOptions,\r\n  SetPublicPathPlugin\r\n} from '@microsoft/set-webpack-public-path-plugin';\r\nimport { IClientSideComponentManifest } from '@microsoft/sp-module-interfaces';\r\nimport {\r\n  IConfigBundle,\r\n  IConfigComponent\r\n} from './../configJson/index';\r\n\r\nimport { getExternalsKeys } from './ExternalsProcessor';\r\nimport { ConfigureExternalBundlingWebpackTask } from './ConfigureExternalBundlingWebpackTask';\r\nimport OdspGulpTask, { ILocaleMap, IResolveResourcesResult } from './../OdspGulpTask';\r\nimport { getFullHash } from './../utilities/FileUtils';\r\n\r\nexport interface IConfigureWebpackTaskConfig {\r\n  webpack?: WebpackTask;\r\n  webpackPublicPathOptions?: ISetWebpackPublicPathPluginOptions;\r\n  libraryName?: string;\r\n  libraryTarget?: string;\r\n  configureExternalBundlingWebpackTask?: ConfigureExternalBundlingWebpackTask;\r\n\r\n  /**\r\n   * If set, drop the webpack stats object and visualization in this directory in addition to the temp directory.\r\n   */\r\n  statsObjectsDropLocation?: string;\r\n\r\n  /**\r\n   * An optional callback can be provided that allows the generated webpack configuration to be modified.\r\n   */\r\n  additionalConfiguration?: (generatedConfiguration: webpack.Configuration) => webpack.Configuration;\r\n\r\n  /**\r\n   * An optional list of linked externals to include. For example, if you want to bundle react, list \"react\" in this\r\n   *  array. This is only designed to be used in very special cases and is not intended to be used regularly.\r\n   */\r\n  linkedExternalsToBundle?: string[];\r\n}\r\n\r\nexport interface IBundleComponent extends IConfigComponent {\r\n  manifestData: IClientSideComponentManifest;\r\n}\r\n\r\nexport interface IBundleEntry {\r\n  bundleName: string;\r\n  nonLocalizedEntrypointPath?: string;\r\n  localizedEntrypointPaths?: ILocaleMap;\r\n  components: { [id: string]: IBundleComponent };\r\n}\r\n\r\nexport function getComponentsBundleId(manifests: IClientSideComponentManifest[]): string {\r\n  return manifests.map((manifest) => `${manifest.id}_${manifest.version}`).join('+');\r\n}\r\n\r\nexport function getBundleId(bundle: IBundleEntry): string {\r\n  const manifests: IClientSideComponentManifest[] = [];\r\n  Object.keys(bundle.components).forEach((id) => manifests.push(bundle.components[id].manifestData));\r\n  return getComponentsBundleId(manifests);\r\n}\r\n\r\nexport const fileLoaderExts: string[] = ['jpg', 'png', 'woff', 'eot', 'ttf', 'svg', 'gif'];\r\n\r\n/**\r\n * Configures the @microsoft/gulp-core-build-webpack task with some smart defaults based on the package configuration.\r\n *\r\n * Example:\r\n *  IN:\r\n *    setConfig({\r\n *      webpack: <reference to webpack task>,\r\n *      webpackPublicPathOptions: <options for @microsoft/loader-set-webpack-public-path>,\r\n *      libraryName: <optional library name - set this if the library should be a global on the window>,\r\n *      configureExternalBundlingWebpackTask: <optional reference to ConfigureExternalBundlingWebpackTask task>\r\n *    })\r\n *    buildConfig.properties.entries = [{\r\n *      \"entry\": \"./lib/App.js\",\r\n *      \"manifest\": \"./src/app.manifest.json\",\r\n *      \"outputPath\": \"dist/app.bundle.js\"\r\n *    }]\r\n *    buildConfig.properties.externals = {\r\n *      \"react-dom\": \"node_modules/react-dom/dist/react-dom.js\",\r\n *      \"react\": \"node_modules/react/dist/react.js\",\r\n *      \"flux\": \"node_modules/flux/dist/flux.js\",\r\n *    }\r\n *\r\n *  OUT:\r\n *    set webpack config to (approximately):\r\n *    {\r\n *        context: ... root path ...,\r\n *        entry: { ... mapping of names to entries ... },\r\n *        resolve: {\r\n *          modules: [ ... root path + /node_modules ],\r\n *          alias: { }\r\n *        },\r\n *        output: {\r\n *          library: <library name, if provided>,\r\n *          libraryTarget: <library target, if specified> or 'amd',\r\n *          path: ... dist folder ...,\r\n *          filename: '[name].js',\r\n *          devtoolModuleFilenameTemplate: 'webpack:///../[resource-path]',\r\n *          devtoolFallbackModuleFilenameTemplate: 'webpack:///../[resource-path]?[hash]'\r\n *        },\r\n *        externals: [ ... externals names ... ],\r\n *        module: {\r\n *          noParse: [ /\\.map$/ ],\r\n *          rules: [\r\n *            {\r\n *              test: /\\.css$/,\r\n *              use: [\r\n *                {\r\n *                  loader: `@microsoft/load-themed-styles'\r\n *                },\r\n *                {\r\n *                  loader: 'css-loader',\r\n *                  options: {\r\n *                    minimize: true\r\n *                  }\r\n *                }\r\n *              ]\r\n *            },\r\n *            {\r\n *              test: /\\.(jpg|png|woff|eot|ttf|svg|gif)$/,\r\n *              use: [\r\n *                {\r\n *                  loader: '@microsoft/loader-cased-file',\r\n *                  options: {\r\n *                    name: '[name:lower]_[hash].[ext]'\r\n *                  }\r\n *                }\r\n *              ]\r\n *            },\r\n *            {\r\n *              test: /\\.html$/,\r\n *              use: [\r\n *                {\r\n *                  loader: 'html-loader'\r\n *                }\r\n *              ]\r\n *            }\r\n *          ]\r\n *        },\r\n *        plugins: []\r\n *      }\r\n */\r\nexport class ConfigureWebpackTask extends OdspGulpTask<IConfigureWebpackTaskConfig> {\r\n  private _baseConfig: webpack.Configuration = {\r\n    module: {\r\n      rules: [\r\n        {\r\n          use: [\r\n            {\r\n              loader: require.resolve('@microsoft/loader-load-themed-styles'),\r\n              options: {\r\n                async: true\r\n              }\r\n            },\r\n            {\r\n              loader: require.resolve('css-loader'),\r\n              options: {\r\n                minimize: true\r\n              }\r\n            }\r\n          ],\r\n          test: /\\.css$/\r\n        },\r\n        {\r\n          use: [\r\n            {\r\n              loader: require.resolve('@microsoft/loader-cased-file'),\r\n              options: {\r\n                name: '[name:lower]_[hash].[ext]'\r\n              }\r\n            }\r\n          ],\r\n          test: new RegExp(`\\.(${fileLoaderExts.map((e: string) => lodash.escapeRegExp(e)).join('|')})((\\\\?|\\\\#).+)?$`)\r\n        },\r\n        {\r\n          use: [\r\n            {\r\n              loader: require.resolve('html-loader')\r\n            }\r\n          ],\r\n          test: /\\.html$/\r\n        }\r\n      ],\r\n      noParse: [ /\\.map$/ ]\r\n    },\r\n    resolve: {\r\n      alias: {},\r\n      modules: [\r\n        'node_modules',\r\n        'lib'\r\n      ]\r\n    }\r\n  };\r\n\r\n  constructor() {\r\n    super(\r\n      'configure-webpack',\r\n      {\r\n        libraryName: undefined,\r\n        webpack: undefined,\r\n        webpackPublicPathOptions: undefined,\r\n        additionalConfiguration: undefined,\r\n        configureExternalBundlingWebpackTask: undefined,\r\n        statsObjectsDropLocation: undefined\r\n      }\r\n    );\r\n  }\r\n\r\n  public loadSchema(): Object {\r\n    return require('./configure-webpack.schema.json');\r\n  }\r\n\r\n  public setConfig(config: IConfigureWebpackTaskConfig): void {\r\n    if (config.webpack && config.webpack.name !== 'webpack') {\r\n      this.logWarning('Setting webpack property to non-\"@microsoft/gulp-core-build-webpack\"-type will ' +\r\n                      'prevent configuration');\r\n    }\r\n\r\n    super.mergeConfig(config);\r\n  }\r\n\r\n  public getKarmaConfig(extraRules: webpack.Rule[],\r\n                        externals: webpack.ExternalsElement[],\r\n                        karmaTask: KarmaTask): webpack.Configuration {\r\n    const locAliases: { [id: string]: string } = {};\r\n    try {\r\n      const locResourceKeys: string[] = Object.keys(this.properties.discoveredLocalizedResources || {});\r\n      const resolveResult: IResolveResourcesResult = this.resolveResources(locResourceKeys, undefined, true, karmaTask);\r\n      const locale: string = resolveResult.locales[0];\r\n      for (const resourceId of resolveResult.localizedResourcesToBundle) {\r\n        // Appending \"$\" to the resource ID to ensure paths under it aren't matched. See\r\n        //  https://webpack.js.org/configuration/resolve/#resolve-alias\r\n        locAliases[`${resourceId}$`] = this.properties.discoveredLocalizedResources[resourceId][locale];\r\n      }\r\n    } catch (e) {\r\n      karmaTask.logError(`Error resolving localized resources for test. Tests may fail unexpectedly. Error: ${e}`);\r\n    }\r\n\r\n    const testAddons: webpack.Configuration = {\r\n      externals: externals,\r\n      module: {\r\n        rules: [\r\n          {\r\n            use: [\r\n              {\r\n                loader: 'imports',\r\n                options: {\r\n                  define: false\r\n                }\r\n              }\r\n            ],\r\n            test: /sinon\\.js$/\r\n          }\r\n        ]\r\n      },\r\n      plugins: [new webpack.DefinePlugin({\r\n        DEBUG: !this.buildConfig.production,\r\n        UNIT_TEST: true,\r\n        NPM_BUILD: false,\r\n        BUILD_NUMBER: '\\'unit_test\\'',\r\n        DATACENTER: !this.buildConfig.args['on-prem']\r\n      })],\r\n      resolve: {\r\n        alias: locAliases\r\n      }\r\n    };\r\n\r\n    (testAddons.module as webpack.NewModule).rules.push(...extraRules);\r\n\r\n    return this._appendToBaseConfig(testAddons);\r\n  }\r\n\r\n  public executeTask(gulp: typeof Gulp, completeCallback: (error?: string) => void): NodeJS.ReadWriteStream {\r\n    if (!this.taskConfig.webpack) {\r\n      this.logWarning('\"webpack\" is not defined in the task configuration. Nothing to configure.');\r\n      completeCallback();\r\n      return;\r\n    }\r\n\r\n    const configValidationResult: string | undefined = this._validateEntries();\r\n    if (configValidationResult) {\r\n      completeCallback(configValidationResult);\r\n      return;\r\n    }\r\n\r\n    if (!this.buildConfig.properties) {\r\n      this._logNoEntriesWarning();\r\n      this._setWebpackConfig({});\r\n      completeCallback();\r\n      return;\r\n    }\r\n\r\n    // The ConfigureExternalBundlingWebpackTask will disable the second webpack task\r\n    // when doing a dev build or in a project without localized resources.\r\n    // This, however, breaks gulp serve. Therefore, we should ensure the webpack task is activated.\r\n    // @todo 261553 - this should be removed when we do this refactor\r\n    this.taskConfig.webpack.isEnabled = () => true;\r\n\r\n    const configBundleEntries: { [name: string]: IConfigBundle } = this.properties.bundles || {};\r\n\r\n    const externalsKeys: string[] = getExternalsKeys(this);\r\n\r\n    // Remove the specified linked externals to ensure they're bundled\r\n    if (this.taskConfig.linkedExternalsToBundle && this.taskConfig.linkedExternalsToBundle.length) {\r\n      for (const linkedExternalToBundle of this.taskConfig.linkedExternalsToBundle) {\r\n        const linkedExternalToBundleIndex: number = externalsKeys.indexOf(linkedExternalToBundle);\r\n        if (linkedExternalToBundleIndex !== -1) {\r\n          externalsKeys.splice(linkedExternalToBundleIndex, 1);\r\n        }\r\n      }\r\n    }\r\n\r\n    const localizedResources: { [name: string]: string } = this.properties.localizedResources || {};\r\n    const localizedResourcesKeys: string[] = Object.keys(localizedResources);\r\n\r\n    const configBundleEntriesCount: number = Object.keys(configBundleEntries).length;\r\n    if (configBundleEntriesCount === 0) {\r\n      this._logNoEntriesWarning();\r\n      this.taskConfig.webpack.isEnabled = () => false;\r\n      completeCallback();\r\n      return;\r\n    }\r\n\r\n    this.logVerbose(`${configBundleEntriesCount} entries specified.`);\r\n    this.logVerbose(`${externalsKeys.length} externals specified.`);\r\n    this.logVerbose(`${localizedResourcesKeys.length} localized resources specified.`);\r\n\r\n    localizedResourcesKeys.forEach((key: string) => {\r\n      if (externalsKeys.indexOf(key) !== -1) {\r\n        this.logError(`Invalid Configuration: Key \"${key}\" is specified in both externals and localizedResources.`);\r\n      }\r\n    });\r\n\r\n    const webpackPublicPathOptions: ISetWebpackPublicPathPluginOptions =\r\n        lodash.clone(this.taskConfig.webpackPublicPathOptions) || {};\r\n    if (!webpackPublicPathOptions.systemJs) {\r\n      lodash.merge(webpackPublicPathOptions, {\r\n        scriptName: {\r\n          name: '[name]_?[a-zA-Z0-9-_]*\\.js',\r\n          isTokenized: true\r\n        }\r\n      } as ISetWebpackPublicPathPluginOptions);\r\n    }\r\n\r\n    // Users can use the --entry to control which entries actually get bundled\r\n    // This value can match the GUID or the alias\r\n    const entryParam: string = this.buildConfig.args['entry'] as string; // tslint:disable-line:no-string-literal\r\n\r\n    this.properties.bundleEntries = [];\r\n    const webpackEntries: { [name: string]: string } = {};\r\n    let foundEntry: boolean;\r\n\r\n    for (const bundleName in configBundleEntries) {\r\n      if (configBundleEntries.hasOwnProperty(bundleName)) {\r\n        const configEntry: IConfigBundle = configBundleEntries[bundleName];\r\n        let shouldBundleEntry: boolean = entryParam === undefined;\r\n        const bundleEntry: IBundleEntry = {\r\n          bundleName,\r\n          nonLocalizedEntrypointPath: path.join(this.outputDirectory, `${bundleName}.js`),\r\n          components: {}\r\n        };\r\n\r\n        for (const componentEntry of configEntry.components) {\r\n          const manifestData: IClientSideComponentManifest = this.getManifest(componentEntry.manifest);\r\n\r\n          // If the manifest version is \"*\", replace it with the package version. Do this here to make sure the\r\n          //  bundle's name doesn't contain the \"*\" version\r\n          if (manifestData.version === '*') {\r\n            const manifestVersion: string = this.getPackageVersion();\r\n            manifestData.version = manifestVersion;\r\n          }\r\n\r\n          shouldBundleEntry = shouldBundleEntry ||\r\n            ( entryParam && manifestData &&\r\n              ( manifestData.id.toLowerCase() === entryParam.toLowerCase() ||\r\n                manifestData.alias.toLowerCase() === entryParam.toLowerCase() ) );\r\n\r\n          if (entryParam === undefined || shouldBundleEntry) {\r\n            foundEntry = true;\r\n\r\n            // Keep a counter of the manifests inside the bundle so we can set the exportName property in the produced\r\n            //  manifest(s) and generate a JS file to bundle both components' entrypoints\r\n            bundleEntry.components[manifestData.id] = {\r\n              ...componentEntry,\r\n              manifestData\r\n            };\r\n          }\r\n        }\r\n\r\n        if (shouldBundleEntry) {\r\n          const componentKeys: string[] = Object.keys(bundleEntry.components);\r\n          if (componentKeys.length === 1) {\r\n            // Single component, just point to its entrypoint in the webpack config\r\n            webpackEntries[bundleName] = path.join(\r\n              this.buildConfig.rootPath,\r\n              bundleEntry.components[componentKeys[0]].entrypoint\r\n            );\r\n          } else {\r\n            // Multiple components, we need to generate an entry to point the webpack config at\r\n            webpackEntries[bundleName] = this._generateBundleEntrypointFile(bundleEntry);\r\n          }\r\n\r\n          this.properties.bundleEntries.push(bundleEntry);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (entryParam && !foundEntry) {\r\n      completeCallback(`The \"--entry\" flag was specified, but \"${entryParam}\" did not match ` +\r\n        `the id or alias of any entries listed in config.json`);\r\n      return;\r\n    }\r\n\r\n    this.properties.webpackLibraryName = this.taskConfig.libraryName || (() => {\r\n      if (this.properties.bundleEntries.length === 0) {\r\n        // We're not producing any bundles, so we don't need to worry about the library name\r\n        return undefined;\r\n      } else if (this.properties.bundleEntries.length === 1) {\r\n        // We're producing one bundle, so we can generate a simple name\r\n        return getBundleId(this.properties.bundleEntries[0]);\r\n      } else {\r\n        // There are multiple bundles. Because we need something unique for the webpack JSONP function, we'll just\r\n        //  concatenate the IDs and then hash them. In the post-bundle steps, we'll replace the \"define(<name>, ...\"\r\n        //  name with the real IDs. When we update this task to support multiple webpack configurations, we can\r\n        //  separate each bundle to have its own library name.\r\n        this.properties.webpackLibraryNameIsTemporary = true;\r\n        return getFullHash(this.properties.bundleEntries.map((bundle) => getBundleId(bundle)).join(''));\r\n      }\r\n    })();\r\n\r\n    const configAddons: webpack.Configuration = {\r\n      context: this.buildConfig.rootPath,\r\n      devtool: this.buildConfig.production ? undefined : 'source-map',\r\n      entry: webpackEntries,\r\n      externals: externalsKeys.concat(localizedResourcesKeys),\r\n      module: {\r\n        rules: [\r\n          {\r\n            test: /\\.js$/,\r\n            enforce: 'pre',\r\n            use: require.resolve('source-map-loader')\r\n          }\r\n        ]\r\n      },\r\n      output: {\r\n        chunkFilename: '[id].[name]_[chunkhash].js',\r\n        filename: '[name].js',\r\n        library: this.properties.webpackLibraryName,\r\n        libraryTarget: this.taskConfig.libraryTarget || 'amd',\r\n        path: this.outputDirectory,\r\n        devtoolModuleFilenameTemplate: 'webpack:///../[resource-path]',\r\n        devtoolFallbackModuleFilenameTemplate: 'webpack:///../[resource-path]?[hash]'\r\n      },\r\n      plugins: [\r\n        new SetPublicPathPlugin(webpackPublicPathOptions)\r\n      ]\r\n    };\r\n\r\n    this._includeStatsPlugin(path.join(this.buildConfig.rootPath, this.buildConfig.tempFolder, `stats`), configAddons);\r\n\r\n    if (this.taskConfig.statsObjectsDropLocation) {\r\n      const resolvedPath: string = path.resolve(this.buildConfig.rootPath, this.taskConfig.statsObjectsDropLocation);\r\n      this._includeStatsPlugin(resolvedPath, configAddons);\r\n    }\r\n\r\n    if (this.buildConfig.production) {\r\n      configAddons.plugins.push(new webpack.optimize.UglifyJsPlugin({\r\n        compress: {\r\n          dead_code: true,\r\n          warnings: false\r\n        },\r\n        mangle: true\r\n      }));\r\n    }\r\n\r\n    let buildNumber: string = undefined;\r\n    if (process.env.BUILD_BUILDNUMBER) {\r\n      buildNumber = `\\'${process.env.BUILD_BUILDNUMBER.toLowerCase()}\\'`;\r\n    }\r\n\r\n    configAddons.plugins.push(new webpack.DefinePlugin({\r\n      DEBUG: !this.buildConfig.production,\r\n      UNIT_TEST: false,\r\n      NPM_BUILD: this.npmBuild,\r\n      BUILD_NUMBER: buildNumber\r\n    }));\r\n\r\n    let config: webpack.Configuration = this._appendToBaseConfig(configAddons);\r\n    if (this.taskConfig.configureExternalBundlingWebpackTask) {\r\n      this.taskConfig.configureExternalBundlingWebpackTask.tinkerWithBaseWebpackConfig(config);\r\n    }\r\n\r\n    if (this.taskConfig.additionalConfiguration) {\r\n      config = this.taskConfig.additionalConfiguration(config);\r\n    }\r\n\r\n    this._setWebpackConfig(config);\r\n\r\n    completeCallback();\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Modify the localized webpack config to make sure the end result is correct.\r\n   *\r\n   * @internal\r\n   */\r\n  public tinkerWithLocConfig(config: webpack.Configuration): void {\r\n    config.output.libraryTarget = this.taskConfig.libraryTarget || 'amd';\r\n  }\r\n\r\n  private _includeStatsPlugin(dropPath: string, config: webpack.Configuration): void {\r\n    // tslint:disable-next-line:typedef variable-name\r\n    const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;\r\n    const lastDirName: string = path.basename(this.buildConfig.rootPath);\r\n\r\n    config.plugins.push(new BundleAnalyzerPlugin({\r\n        openAnalyzer: false,\r\n        analyzerMode: 'static',\r\n        reportFilename: path.join(dropPath, `${lastDirName}.stats.html`),\r\n        generateStatsFile: true,\r\n        statsFilename: path.join(dropPath, `${lastDirName}.stats.json`),\r\n        logLevel: 'error'\r\n      }));\r\n  }\r\n\r\n  private _appendToBaseConfig(config: webpack.Configuration): webpack.Configuration {\r\n    return lodash.mergeWith({}, this._baseConfig, config, (value1: any, value2: any) => { // tslint:disable-line:no-any\r\n      if (lodash.isArray(value1) && lodash.isArray(value2)) {\r\n        return lodash.concat(value1, value2);\r\n      } else {\r\n        return undefined;\r\n      }\r\n    });\r\n  }\r\n\r\n  private _logNoEntriesWarning(): void {\r\n    this.logWarning('No entries are defined, so no bundles will be produced.');\r\n  }\r\n\r\n  private _setWebpackConfig(config: webpack.Configuration): void {\r\n    const webpackTask: WebpackTask = this.taskConfig.webpack;\r\n    const sourceMapWarningSuppression: RegExp = /Cannot find SourceMap \\'.+\\'\\: Error\\:/;\r\n    const suppressedWarnings: (string | RegExp)[] = webpackTask.taskConfig.suppressWarnings || [];\r\n\r\n    if (webpackTask) {\r\n      webpackTask.setConfig({\r\n        config: config as any, // tslint:disable-line:no-any\r\n        configPath: null, // tslint:disable-line:no-null-keyword\r\n        suppressWarnings: suppressedWarnings.concat([sourceMapWarningSuppression])\r\n      });\r\n    }\r\n  }\r\n\r\n  private _validateEntries(): string | undefined {\r\n    if (this.properties.bundles) {\r\n      const entrypointPaths: Set<string> = new Set<string>();\r\n      const manifestPaths: Set<string> = new Set<string>();\r\n\r\n      for (const bundleName in this.properties.bundles) {\r\n        if (this.properties.bundles.hasOwnProperty(bundleName)) {\r\n          const bundleEntry: IConfigBundle = this.properties.bundles[bundleName];\r\n          for (const component of bundleEntry.components) {\r\n            const entrypointPath: string =\r\n              path.resolve(path.join(this.buildConfig.rootPath, component.entrypoint)).toUpperCase();\r\n            if (entrypointPaths.has(entrypointPath)) {\r\n              return `Entry path \"${entrypointPath}\" occurs in multiple config.json components. This is not supported.`;\r\n            } else {\r\n              entrypointPaths.add(entrypointPath);\r\n            }\r\n\r\n            const manifestPath: string =\r\n              path.resolve(path.join(this.buildConfig.rootPath, component.manifest)).toUpperCase();\r\n            if (manifestPaths.has(manifestPath)) {\r\n              return `Manifest path \"${manifestPath}\" occurs in multiple config.json components. This is not ` +\r\n                     'supported.';\r\n            } else {\r\n              manifestPaths.add(manifestPath);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Writes the entrypoint file to the temp directory and returns the path to the file.\r\n   */\r\n  private _generateBundleEntrypointFile(bundleEntry: IBundleEntry): string {\r\n    const filePath: string = path.join(\r\n      this.buildConfig.rootPath,\r\n      this.buildConfig.tempFolder,\r\n      'bundle-entries',\r\n      `${bundleEntry.bundleName}.js`\r\n    );\r\n\r\n    const fileContents: string = [\r\n      'Object.defineProperty(exports, \"__esModule\", { value: true });',\r\n      ...Object.keys(bundleEntry.components).map((id) => {\r\n        const fullEntrypointPath: string = path.join(this.buildConfig.rootPath, bundleEntry.components[id].entrypoint);\r\n        return `exports['${id}'] = require('${fullEntrypointPath.replace(/\\\\/g, '\\\\\\\\')}');`;\r\n      })\r\n    ].join(EOL);\r\n    fsx.ensureDirSync(path.dirname(filePath));\r\n    fsx.writeFileSync(filePath, fileContents);\r\n\r\n    return filePath;\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\src"}